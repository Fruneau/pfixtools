match1 {
  type = match;

  condition = stress #=;
  on_match  = postfix:OK;
  on_fail   = postfix:OK;
}

hostnames1 {
  type = strlist;

  fields = helo_name,client_name;
  file   = nolock:suffix:1:data/test_hostnames_1;
  file   = nolock:prefix:4:data/test_hostnames_2;
  file   = nolock:suffix:8:data/test_hostnames_3;

  soft_threshold = 1;
  hard_threshold = 5;

  on_hard_match = postfix:OK;
  on_soft_match = postfix:OK;
  on_fail = postfix:OK;
}

hostnames2 {
  type = strlist;

  fields = helo_name,client_name,reverse_client_name;
  file   = nolock:suffix:1:data/test_hostnames_1;
  file   = nolock:prefix:4:data/test_hostnames_2;
  file   = nolock:suffix:8:data/test_hostnames_3;

  soft_threshold = 1;
  hard_threshold = 5;

  on_hard_match = postfix:OK;
  on_soft_match = postfix:OK;
  on_fail = postfix:OK;
}

emails1 {
  type = strlist;

  fields = sender;
  file   = nolock:suffix:1:data/test_emails_1;
  file   = nolock:prefix:4:data/test_emails_2;
  file   = nolock:suffix:8:data/test_emails_3;

  soft_threshold = 1;
  hard_threshold = 5;

  on_hard_match = postfix:ok;
  on_soft_match = postfix:ok;
  on_fail = postfix:ok;
}

emails2 {
  type = strlist;

  fields = sender,recipient;
  file   = nolock:suffix:1:data/test_emails_1;
  file   = nolock:prefix:4:data/test_emails_2;
  file   = nolock:suffix:8:data/test_emails_3;

  soft_threshold = 1;
  hard_threshold = 5;

  on_hard_match = postfix:ok;
  on_soft_match = postfix:ok;
  on_fail = postfix:ok;
}

recipient_filter = match1;
